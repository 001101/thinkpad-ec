#!/bin/bash
#
# Quick and dirty extracter to get the EC image out of the iso file
#
# TODO:
# - a tool that is portable to Windows
# - should output dependancy information

OUT="$1"
if [ -z "$OUT" ]; then
    echo Need output filename
    exit 1
fi

# assume that output filename is blahdyblah.img.orig
OUT1=$(basename "$OUT" .orig).enc.orig

dd if=g2uj23us.iso.orig bs=$[0x1076600] skip=1 | dd bs=196608 count=1 of="$OUT1"

mec-tools/mec_encrypt -d "$OUT1" >"$OUT"

